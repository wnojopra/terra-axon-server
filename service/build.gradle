plugins {
    id 'bio.terra.axonserver.java-spring-conventions'
    id 'de.undercouch.download'
    id 'com.google.cloud.tools.jib'
    id 'com.gorylenko.gradle-git-properties' version '2.3.1'
}

apply from: "$projectDir/gradle/generators.gradle"
apply from: "$projectDir/gradle/publishing.gradle"
apply from: "$projectDir/gradle/dependency-locking.gradle"

dependencies {
    // Google dependencies
    constraints {
        implementation 'com.google.guava:guava:31.1-jre' // "-jre" for Java 8 or higher
    }
    implementation group: 'commons-io', name: 'commons-io', version: '2.11.0'

    // auth
    implementation 'com.google.oauth-client:google-oauth-client:1.30.4'
    implementation 'com.google.http-client:google-http-client-gson:1.42.1'
    implementation 'com.google.api-client:google-api-client:2.0.0'

    // Google cloud bom
    implementation platform('com.google.cloud:libraries-bom:25.1.0')
    implementation group: 'com.google.cloud', name: 'google-cloud-storage', version: '2.17.2'

    // AWS dependencies
    implementation platform('software.amazon.awssdk:bom:2.18.34')
    implementation 'software.amazon.awssdk:sts'

    // Terra Common Library
    implementation('bio.terra:terra-common-lib:0.0.86-SNAPSHOT') {
        exclude group: 'org.broadinstitute.dsde.workbench', module: 'sam-client_2.12'
    }

    // Terra Cloud Resource library
    implementation group: 'bio.terra', name: 'terra-cloud-resource-lib', version: '1.2.15-SNAPSHOT'

    // Terra Sam Client
    implementation group: 'org.broadinstitute.dsde.workbench', name: 'sam-client_2.13', version: '0.1-ffb0a89-SNAP'

    // Terra Workspace Manager Client
    implementation group: 'bio.terra', name: 'workspace-manager-client', version: '0.254.676-SNAPSHOT'

    // Spring dependencies
    implementation 'org.apache.commons:commons-lang3'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'javax.ws.rs:javax.ws.rs-api:2.1.1'
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'javax.servlet:jstl:1.2'

    // Testing dependencies
    testImplementation 'org.junit.jupiter:junit-jupiter-api'
    testImplementation('org.springframework.boot:spring-boot-starter-test') {
        // Fixes warning about multiple occurrences of JSONObject on the classpath
        exclude group: 'com.vaadin.external.google', module: 'android-json'
    }
}

test {
    useJUnitPlatform ()
}
